#!/bin/bash
#SBATCH --account=%ACCOUNT%
#SBATCH --array=1-%NJOBS%
#SBATCH --ntasks=1                   # number of MPI processes
#SBATCH --mem-per-cpu=3G             # memory; default unit is megabytes
#SBATCH --time=0-%TARGET%:00         # time (DD-HH:MM)
#SBATCH --output=%CAMPAIGN_LOG%/LOG/SLURM/slurm_%A/slurm_%A_%a.out # standard output log
#SBATCH --error=%CAMPAIGN_LOG%/LOG/SLURM/slurm_%A/slurm_%A_%a.err  # standard error log

input_string=$(sed "${SLURM_ARRAY_TASK_ID}q;d" %CSV_FILE%)
read -r file ext nevents ichunk <<< $(echo "$input_string" | awk -F',' '{print $1, $2, $3, $4}')

echo $file
echo $ext
echo $nevents
echo $ichunk

cat << EOF | $(dirname %EXECUTABLE%)/eic-shell

%EXECUTABLE% %ARGUMENTS% $file $ext $nevents $ichunk

EOF
